import{aH as a,i,aI as c}from"./index.c3b897a7.js";var r="/spark-store-qe/assets/application.bc4a430e.svg";const n=a("counter",{state:()=>({sortCache:{config:{cardWidth:264,cardHeight:92,verticalPadding:50,horizonPadding:16,gap:32},sort:null,appList:[],containerState:{active:!1,animation:!1,cover:!1},coverState:{active:!1,animation:!1,cover:!1,application:!1,open:!1,loaded:!1,applicationEnd:!1},activeCard:null,containerHeight:"",column:0,columnAnimation:{change:!1,oldColumn:0,newColumn:0},horizonGap:0,cover:{style:""},scrollTop:0,clientWidth:0,clientHeight:0},source:"https://d.store.deepinos.org.cn",debSource:"https://mirrors.sdu.edu.cn/spark-store-repository/store/"}),getters:{},actions:{setActiveCard(t){this.sortCache.activeCard=t,this.refreshStyle()},cancelActiveCard(){this.sortCache.coverState.active=!1,this.sortCache.coverState.open=!1,this.sortCache.coverState.loaded=!1,this.sortCache.coverState.animation=!0,this.sortCache.coverState.applicationEnd=!1,this.sortCache.containerState.cover=!1},setImgError(t,o){t.imgError=o;const e=`${this.source}/store/${this.sortCache.sort}/${t.Package.replaceAll("+","%2B")}/icon.png`;t.imgSrc=t.imgError?r:e},onContainerWidthChange(t){this.sortCache.clientWidth=t,this.sortCache.columnAnimation.oldColumn=this.sortCache.column,this.sortCache.column=Math.floor((t+this.sortCache.config.gap-this.sortCache.config.horizonPadding*2)/(this.sortCache.config.cardWidth+this.sortCache.config.gap)),this.sortCache.containerHeight=`${Math.ceil(this.sortCache.appList.length/this.sortCache.column)*(this.sortCache.config.cardHeight+this.sortCache.config.gap)+this.sortCache.config.gap+this.sortCache.config.verticalPadding*1.5}px`,this.sortCache.horizonGap=(t-(this.sortCache.config.cardWidth+this.sortCache.config.gap)*this.sortCache.column+this.sortCache.config.gap-this.sortCache.config.horizonPadding*2)/(this.sortCache.column+1),this.sortCache.appList.forEach((o,e)=>{o.position={left:e%this.sortCache.column*(this.sortCache.horizonGap+this.sortCache.config.gap+this.sortCache.config.cardWidth)+this.sortCache.config.horizonPadding+this.sortCache.horizonGap,top:Math.floor(e/this.sortCache.column)*(this.sortCache.config.cardHeight+this.sortCache.config.gap)+this.sortCache.config.verticalPadding},o.style=`transform:translate(${o.position.left}px,${o.position.top}px)`}),this.sortCache.columnAnimation.oldColumn!=this.sortCache.column&&this.sortCache.columnAnimation.oldColumn!=0&&(this.sortCache.columnAnimation.change=!0,this.sortCache.columnAnimation.newColumn=this.sortCache.column),this.refreshStyle()},onScroll(t){this.sortCache.scrollTop=t,this.refreshStyle()},onClientHeightChange(t){this.sortCache.clientHeight=t,this.refreshStyle()},refreshStyle(){var t,o,e,s;this.sortCache.cover.style=`--j-left:${((o=(t=this.sortCache.activeCard)==null?void 0:t.position)==null?void 0:o.left)-this.sortCache.clientWidth/2-30}px;--j-top:${((s=(e=this.sortCache.activeCard)==null?void 0:e.position)==null?void 0:s.top)-this.sortCache.clientHeight/2-this.sortCache.scrollTop-15}px;`}}});function l(){return i(c)}export{l as a,n as u};
